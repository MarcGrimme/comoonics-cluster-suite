<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE enterprisecopy SYSTEM "file:/opt/atix/comoonics-cs/xml/comoonics-enterprise-copy.dtd">
<enterprisecopy name='test-archiveclone'>
  <copyset type='partition'>
    <source type='backup'>
      <metadata>
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/metaarchiv.tar.gz">
        	<file name="./bootpartition.xml"/>
        </archive>
      </metadata>
    </source>
    <destination type='disk'>
      <disk name='/dev/sdd'/>
    </destination>
  </copyset>
  <copyset type='partition'>
    <source type='backup'>
      <metadata>
        <!-- muss das metafile element in oder unter dem archiv element sein ? -->
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/metaarchiv.tar.gz">
        	<file name="./rootpartition.xml"/>
        </archive>
      </metadata>
    </source>
    <destination type='disk'>
      <disk name='/dev/sde'/>
    </destination>
  </copyset>
  <copyset type='lvm'>
    <source type='backup'>
      <metadata>
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/metaarchiv.tar.gz">
        	<file name="./rootlvm.xml"/>
        </archive>
      </metadata>
    </source>
    <destination type='lvm'>
      <volumegroup name='VG_SHAREDROOT_new'>
        <logicalvolume name="LV_SHAREDROOT"/>
        <physicalvolume name='/dev/sde'/>
      </volumegroup>
    </destination>
  </copyset>
  <copyset type='filesystem'>
    <source type='backup'>
      <metadata>
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/metaarchiv.tar.gz">
      	  <file name="./rootfs.xml"/>
        </archive>
      </metadata>
      <data>
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/rootdata.tar.gz"/>
      </data>
    </source>
    <destination type='filesystem'>
      <device id='rootfs' name='/dev/VG_SHAREDROOTC/LV_SHAREDROOT'>
        <filesystem clustername='vmwareclusternew' type='gfs'/>
        <mountpoint name='/mnt/dest'>
          <option value='lock_nolock' name='lockproto'/>
        </mountpoint>
      </device>
    </destination>
  </copyset>
  <copyset type='filesystem'>
    <source type='backup'>
      <metadata>
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/metaarchiv.tar.gz">
        	<file name="./bootfs.xml"/>
        </archive>
      </metadata>
      <data>
        <archive type="file" format="tar" compression="gzip" name="/mnt/data/bootdata.tar.gz"/>
      </data>
    </source>
    <destination type='filesystem'>
      <device name='/dev/sdd1'>
        <filesystem type='ext3'/>
        <mountpoint name='/mnt/dest'/>
      </device>
    </destination>
  </copyset>
  <copyset type='bootloader'>
    <source type='none'/>
    <destination type='disk'>
      <disk name='/dev/sdd'/>
      <bootloader type='grub'/>
    </destination>
  </copyset>
  <modificationset type='filesystem'>
    <device refid='rootfs'>
      <modification search='HOSTNAME=.*' replace='HOSTNAME=testhost' type='regexp'>
        <file name='cluster/cdsl/1/etc/sysconfig/network'/>
      </modification>
      <modification type='copy'>
        <data>
          <archive type="file" format="tar" compression="gzip" name="/mnt/data/modificationdata.tar.gz">
  	         <file sourcefile='/etc/comoonics/copysets/gfs-node1/cluster.conf' name='etc/cluster/mycluster.conf'/>
  	      </archive>
  		</data>
      </modification>
    </device>
  </modificationset>
  <modificationset type='filesystem'>
    <device refid='bootfs'>
      <modification type='copy'>
        <requirement dest='/tmp/test' name='/mnt/source/initrd_sr-2.6.9-34.0.1.ELsmp.gz' format='cpio' type='archive'/>
        <data>
          <archive type="file" format="tar" compression="gzip" name="/mnt/data/midificationdata.tar.gz">
 	          <file sourcefile='/etc/comoonics/copysets/gfs-node1/cluster.conf' name='etc/cluster/mycluster.conf'/>
		  </archive>
		</data>
      </modification>
    </device>
  </modificationset>
</enterprisecopy>
